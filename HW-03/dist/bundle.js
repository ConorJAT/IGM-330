(()=>{"use strict";var e,t,r,n,a,o,l,c=function(e,t,r,n){return void 0===n&&(n=1),"rgba(".concat(e,",").concat(t,",").concat(r,",").concat(n,")")},i=function(e,t,r,n,a,o){for(var l=e.createLinearGradient(t,r,n,a),c=0,i=o;c<i.length;c++){var s=i[c];l.addColorStop(s.percent,s.color)}return l},s=(new Uint8Array(128),function(e){t.src=e});const u=function(){function e(e){var t=e.xPos,r=e.yPos,n=e.radius,a=e.barWidth,o=e.barMaxHeight,l=e.barPadding,c=e.fillColor;Object.assign(this,{xPos:t,yPos:r,radius:n,barWidth:a,barMaxHeight:o,barPadding:l,fillColor:c})}return e.prototype.draw=function(){h.fillStyle=this.fillColor,h.strokeStyle="white",h.save(),h.translate(this.xPos,this.yPos),h.rotate(y),h.beginPath(),h.arc(0,0,this.radius,0,2*Math.PI),h.fill(),h.stroke(),h.closePath(),h.restore(),w(this.xPos,this.yPos,this.radius,this.barWidth,this.barMaxHeight,this.barPadding,"white")},e.prototype.changeFillColor=function(e){this.fillColor=e},e}();var h,d,g,v,f,p,y,b=[],m={visualData:"frequency",showGradient:!0,showPlanets:!0,showCircles:!0,showNoise:!1},w=function(e,t,r,n,a,o,l){h.fillStyle=l,h.strokeStyle="black",h.save(),h.translate(e,t),h.rotate(y),h.translate(0,-r);for(var c=0,i=p;c<i.length;c++){var s=i[c]/255;s<.02&&(s=.02),h.translate(n,0),h.rotate(2*Math.PI/128),h.save(),h.scale(1,-1),h.fillRect(0,0,n,a*s),h.restore(),h.translate(o,0)}h.restore()},S=function(r){document.querySelector("#btn-fs").onclick=function(e){console.log("goFullscreen() called"),r.requestFullscreen()};var n=document.querySelector("#btn-play");n.onclick=function(r){var n=r.target;"suspended"==e.state&&e.resume(),"no"==n.dataset.playing?(t.play(),n.dataset.playing="yes"):(t.pause(),n.dataset.playing="no")},document.querySelector("#select-track").onchange=function(e){var t=e.target;s(t.value),"yes"==t.dataset.playing&&n.dispatchEvent(new MouseEvent("click"))},document.querySelector("#select-visual").onchange=function(e){var t=e.target;m.visualData=t.value};var a=document.querySelector("#cb-planets"),o=document.querySelector("#cb-core"),l=document.querySelector("#cb-noise");a.onchange=function(e){var t=e.target;m.showPlanets=t.checked},o.onchange=function(e){var t=e.target;m.showCircles=t.checked},l.onchange=function(e){var t=e.target;m.showNoise=t.checked},document.querySelector("#select-theme").onchange=function(e){var t;"none"!=(t=e.target.value)&&(m.showGradient=!0),"evening"==t?(v=i(h,0,0,0,g,[{percent:0,color:"#00101c"},{percent:.33,color:"#041f3a"},{percent:.67,color:"#083f53"},{percent:1,color:"#239294"}]),b[0].changeFillColor("rgba(14, 111, 128, .9)"),b[1].changeFillColor("rgba(27, 45, 112, .9)"),b[2].changeFillColor("rgba(6, 37, 87, .9)")):"midnight"==t?(v=i(h,0,0,0,g,[{percent:0,color:"#070707"},{percent:.5,color:"#1D1D25"},{percent:1,color:"#263242"}]),b[0].changeFillColor("rgba(48, 68, 92, 0.9)"),b[1].changeFillColor("rgba(42, 42, 56, 0.9)"),b[2].changeFillColor("rgba(35, 35, 43, 0.9)")):"morning"==t?(v=i(h,0,0,0,g,[{percent:0,color:"#0087A5"},{percent:.33,color:"#7FACB2"},{percent:.67,color:"#D4C6AB"},{percent:1,color:"#FAAD51"}]),b[0].changeFillColor("rgba(245, 186, 118, 0.9)"),b[1].changeFillColor("rgba(165, 204, 207, 0.9)"),b[2].changeFillColor("rgba(15, 141, 166, 0.9)")):"afternoon"==t?(v=i(h,0,0,0,g,[{percent:0,color:"#3B589E"},{percent:.33,color:"#6A719F"},{percent:.67,color:"#B28393"},{percent:1,color:"#EC5065"}]),b[0].changeFillColor("rgba(245, 144, 145, 0.9)"),b[1].changeFillColor("rgba(172, 156, 184, 0.9)"),b[2].changeFillColor("rgba(95, 122, 194, 0.9)")):"none"==t&&(m.showGradient=!1,b[0].changeFillColor("white"),b[1].changeFillColor("white"),b[2].changeFillColor("white"))};var c=document.querySelector("#burger"),u=document.querySelector("#nav-links");c.onclick=function(){u.classList.toggle("is-active")}},P=function(){setTimeout(P,1e3/60),function(){if("frequency"==m.visualData?f.getByteFrequencyData(p):"time-domain"==m.visualData&&f.getByteTimeDomainData(p),h.save(),h.fillStyle="black",h.globalAlpha=.1,h.fillRect(0,0,d,g),h.restore(),m.showGradient&&(h.save(),h.fillStyle=v,h.globalAlpha=.3,h.fillRect(0,0,d,g),h.restore()),m.showCircles){var e=g/4;h.save(),h.globalAlpha=.5;for(var t=0;t<p.length;t++){var r=p[t]/255,n=r*e;h.beginPath(),h.fillStyle=c(210,210,210,.34-r/3),h.arc(d/2,g/2,n,0,2*Math.PI,!1),h.fill(),h.closePath(),h.beginPath(),h.fillStyle=c(180,180,180,.1-r/10),h.arc(d/2,g/2,1.5*n,0,2*Math.PI,!1),h.fill(),h.closePath(),h.save(),h.beginPath(),h.fillStyle=c(240,240,240,.5-r/5),h.arc(d/2,g/2,.5*n,0,2*Math.PI,!1),h.fill(),h.closePath(),h.restore()}h.restore()}var a=h.getImageData(0,0,d,g),o=a.data,l=o.length;for(a.width,t=0;t<l;t+=4)m.showNoise&&Math.random()<.05&&(o[t]=o[t+1]=o[t+2]=0,o[t]=255,o[t+1]=255,o[t+2]=255);if(h.putImageData(a,0,0),m.showPlanets)for(var i=0,s=b;i<s.length;i++)s[i].draw();y-=.01}()};window.onload=function(){console.log("window.onload called");var c,m=function(){var t=document.querySelector("#slider-volume"),r=document.querySelector("#label-volume");t.oninput=function(e){var t,n=e.target;t=n.value,t=Number(t),a.gain.value=t,r.innerHTML=String(Math.round(+n.value/2*100))},t.dispatchEvent(new Event("input"));var n=document.querySelector("#slider-treble"),c=document.querySelector("#label-treble");n.oninput=function(t){var r,n=t.target;r=n.value,o.frequency.setValueAtTime(1e3,e.currentTime),o.gain.setValueAtTime(r,e.currentTime),c.innerHTML=String(Math.round(+n.value/20*100))},n.dispatchEvent(new Event("input"));var i=document.querySelector("#slider-bass"),s=document.querySelector("#label-bass");i.oninput=function(t){var r,n=t.target;r=n.value,l.frequency.setValueAtTime(1e3,e.currentTime),l.gain.setValueAtTime(r,e.currentTime),s.innerHTML=String(Math.round(+n.value/20*100))},i.dispatchEvent(new Event("input"))};(c=new XMLHttpRequest).onload=function(e){!function(e){var t;try{t=JSON.parse(e.target.responseText)}catch(e){return void console.log("JSON parse error!")}document.querySelector("title").innerHTML=t.title;for(var r="",n=0,a=t.tracks;n<a.length;n++){var o=a[n];r+="<option value=".concat(o["track-url"],">").concat(o["track-name"],"</option>")}document.querySelector("#select-track").innerHTML=r;for(var l="| ",c=0,i=t.controls;c<i.length;c++){var s=i[c];l+="".concat(s["control-name"],": <input type=range id=").concat(s["control-id"]," min=").concat(s["control-min"]," max=").concat(s["control-max"]," value=").concat(s["control-value"]," step=0.01>"),l+="<span id=".concat(s["control-label"],">???</span>"),l+=" | "}document.querySelector("#slider-controls").innerHTML=l,m(),document.querySelector("header").innerHTML="<h1>".concat(t.title,"</h1><p>").concat(t.instructions,"</p>")}(e)},c.open("GET","./data/av-data.json"),c.send(),function(){var c;c=window.AudioContext,e=new c,t=new Audio,s("media/DifferentHeaven&SianArea-FeelLikeHorrible.mp3"),r=e.createMediaElementSource(t),(n=e.createAnalyser()).fftSize=256,(o=e.createBiquadFilter()).type="highshelf",o.frequency.setValueAtTime(1e3,e.currentTime),(l=e.createBiquadFilter()).type="lowshelf",l.frequency.setValueAtTime(1e3,e.currentTime),(a=e.createGain()).gain.value=.5,r.connect(o),o.connect(l),l.connect(n),n.connect(a),a.connect(e.destination);var m=document.querySelector("canvas");S(m),function(e,t){h=e.getContext("2d"),d=e.width,g=e.height,v=i(h,0,0,0,g,[{percent:0,color:"#00101c"},{percent:.33,color:"#041f3a"},{percent:.67,color:"#083f53"},{percent:1,color:"#239294"}]),f=t,p=new Uint8Array(f.fftSize/2),b=[new u({xPos:540,yPos:620,radius:184,barWidth:5,barMaxHeight:100,barPadding:4,fillColor:"rgba(14, 111, 128, .9)"}),new u({xPos:880,yPos:300,radius:120,barWidth:2.9,barMaxHeight:60,barPadding:3,fillColor:"rgba(27, 45, 112, .9)"}),new u({xPos:200,yPos:180,radius:50,barWidth:1.4,barMaxHeight:40,barPadding:1,fillColor:"rgba(6, 37, 87, .9)"})],y=0}(m,n),P()}()}})();
//# sourceMappingURL=bundle.js.map