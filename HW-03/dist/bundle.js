(()=>{"use strict";var e,t,r,n,a,o,l,c=function(e,t,r,n){return void 0===n&&(n=1),"rgba(".concat(e,",").concat(t,",").concat(r,",").concat(n,")")},i=function(e,t,r,n,a,o){for(var l=e.createLinearGradient(t,r,n,a),c=0,i=o;c<i.length;c++){var s=i[c];l.addColorStop(s.percent,s.color)}return l},s=Object.freeze({gain:.5,numSamples:256}),u=(new Uint8Array(s.numSamples/2),function(e){t.src=e});const h=function(){function e(e){var t=e.xPos,r=e.yPos,n=e.radius,a=e.barWidth,o=e.barMaxHeight,l=e.barPadding,c=e.fillColor;Object.assign(this,{xPos:t,yPos:r,radius:n,barWidth:a,barMaxHeight:o,barPadding:l,fillColor:c})}return e.prototype.draw=function(){d.fillStyle=this.fillColor,d.strokeStyle="white",d.save(),d.translate(this.xPos,this.yPos),d.rotate(m),d.beginPath(),d.arc(0,0,this.radius,0,2*Math.PI),d.fill(),d.stroke(),d.closePath(),d.restore(),S(this.xPos,this.yPos,this.radius,this.barWidth,this.barMaxHeight,this.barPadding,"white")},e.prototype.changeFillColor=function(e){this.fillColor=e},e}();var d,g,f,v,p,b,m,y=[],w={visualData:"frequency",showGradient:!0,showPlanets:!0,showCircles:!0,showNoise:!1},S=function(e,t,r,n,a,o,l){d.fillStyle=l,d.strokeStyle="black",d.save(),d.translate(e,t),d.rotate(m),d.translate(0,-r);for(var c=0,i=b;c<i.length;c++){var s=i[c]/255;s<.02&&(s=.02),d.translate(n,0),d.rotate(2*Math.PI/128),d.save(),d.scale(1,-1),d.fillRect(0,0,n,a*s),d.restore(),d.translate(o,0)}d.restore()},P=Object.freeze({sound1:"media/DifferentHeaven&SianArea-FeelLikeHorrible.mp3"}),C=function(r){document.querySelector("#btn-fs").onclick=function(e){console.log("goFullscreen() called"),r.requestFullscreen()};var n=document.querySelector("#btn-play");n.onclick=function(r){var n=r.target;"suspended"==e.state&&e.resume(),"no"==n.dataset.playing?(t.play(),n.dataset.playing="yes"):(t.pause(),n.dataset.playing="no")},document.querySelector("#select-track").onchange=function(e){var t=e.target;u(t.value),"yes"==t.dataset.playing&&n.dispatchEvent(new MouseEvent("click"))},document.querySelector("#select-visual").onchange=function(e){var t=e.target;w.visualData=t.value};var a=document.querySelector("#cb-planets"),o=document.querySelector("#cb-core"),l=document.querySelector("#cb-noise");a.onchange=function(e){var t=e.target;w.showPlanets=t.checked},o.onchange=function(e){var t=e.target;w.showCircles=t.checked},l.onchange=function(e){var t=e.target;w.showNoise=t.checked},document.querySelector("#select-theme").onchange=function(e){var t;"none"!=(t=e.target.value)&&(w.showGradient=!0),"evening"==t?(v=i(d,0,0,0,f,[{percent:0,color:"#00101c"},{percent:.33,color:"#041f3a"},{percent:.67,color:"#083f53"},{percent:1,color:"#239294"}]),y[0].changeFillColor("rgba(14, 111, 128, .9)"),y[1].changeFillColor("rgba(27, 45, 112, .9)"),y[2].changeFillColor("rgba(6, 37, 87, .9)")):"midnight"==t?(v=i(d,0,0,0,f,[{percent:0,color:"#070707"},{percent:.5,color:"#1D1D25"},{percent:1,color:"#263242"}]),y[0].changeFillColor("rgba(48, 68, 92, 0.9)"),y[1].changeFillColor("rgba(42, 42, 56, 0.9)"),y[2].changeFillColor("rgba(35, 35, 43, 0.9)")):"morning"==t?(v=i(d,0,0,0,f,[{percent:0,color:"#0087A5"},{percent:.33,color:"#7FACB2"},{percent:.67,color:"#D4C6AB"},{percent:1,color:"#FAAD51"}]),y[0].changeFillColor("rgba(245, 186, 118, 0.9)"),y[1].changeFillColor("rgba(165, 204, 207, 0.9)"),y[2].changeFillColor("rgba(15, 141, 166, 0.9)")):"afternoon"==t?(v=i(d,0,0,0,f,[{percent:0,color:"#3B589E"},{percent:.33,color:"#6A719F"},{percent:.67,color:"#B28393"},{percent:1,color:"#EC5065"}]),y[0].changeFillColor("rgba(245, 144, 145, 0.9)"),y[1].changeFillColor("rgba(172, 156, 184, 0.9)"),y[2].changeFillColor("rgba(95, 122, 194, 0.9)")):"none"==t&&(w.showGradient=!1,y[0].changeFillColor("white"),y[1].changeFillColor("white"),y[2].changeFillColor("white"))}},q=function(){setTimeout(q,1e3/60),function(){if("frequency"==w.visualData?p.getByteFrequencyData(b):"time-domain"==w.visualData&&p.getByteTimeDomainData(b),d.save(),d.fillStyle="black",d.globalAlpha=.1,d.fillRect(0,0,g,f),d.restore(),w.showGradient&&(d.save(),d.fillStyle=v,d.globalAlpha=.3,d.fillRect(0,0,g,f),d.restore()),w.showCircles){var e=f/4;d.save(),d.globalAlpha=.5;for(var t=0;t<b.length;t++){var r=b[t]/255,n=r*e;d.beginPath(),d.fillStyle=c(210,210,210,.34-r/3),d.arc(g/2,f/2,n,0,2*Math.PI,!1),d.fill(),d.closePath(),d.beginPath(),d.fillStyle=c(180,180,180,.1-r/10),d.arc(g/2,f/2,1.5*n,0,2*Math.PI,!1),d.fill(),d.closePath(),d.save(),d.beginPath(),d.fillStyle=c(240,240,240,.5-r/5),d.arc(g/2,f/2,.5*n,0,2*Math.PI,!1),d.fill(),d.closePath(),d.restore()}d.restore()}var a=d.getImageData(0,0,g,f),o=a.data,l=o.length;for(a.width,t=0;t<l;t+=4)w.showNoise&&Math.random()<.05&&(o[t]=o[t+1]=o[t+2]=0,o[t]=255,o[t+1]=255,o[t+2]=255);if(d.putImageData(a,0,0),w.showPlanets)for(var i=0,s=y;i<s.length;i++)s[i].draw();m-=.01}()};window.onload=function(){console.log("window.onload called");var c,w=function(){var t=document.querySelector("#slider-volume"),r=document.querySelector("#label-volume");t.oninput=function(e){var t,n=e.target;t=n.value,t=Number(t),a.gain.value=t,r.innerHTML=String(Math.round(+n.value/2*100))},t.dispatchEvent(new Event("input"));var n=document.querySelector("#slider-treble"),c=document.querySelector("#label-treble");n.oninput=function(t){var r,n=t.target;r=n.value,o.frequency.setValueAtTime(1e3,e.currentTime),o.gain.setValueAtTime(r,e.currentTime),c.innerHTML=String(Math.round(+n.value/20*100))},n.dispatchEvent(new Event("input"));var i=document.querySelector("#slider-bass"),s=document.querySelector("#label-bass");i.oninput=function(t){var r,n=t.target;r=n.value,l.frequency.setValueAtTime(1e3,e.currentTime),l.gain.setValueAtTime(r,e.currentTime),s.innerHTML=String(Math.round(+n.value/20*100))},i.dispatchEvent(new Event("input"))};(c=new XMLHttpRequest).onload=function(e){!function(e){var t;try{t=JSON.parse(e.target.responseText)}catch(e){return void console.log("JSON parse error!")}document.querySelector("title").innerHTML=t.title;for(var r="",n=0,a=t.tracks;n<a.length;n++){var o=a[n];r+="<option value=".concat(o["track-url"],">").concat(o["track-name"],"</option>")}document.querySelector("#select-track").innerHTML=r;for(var l="| ",c=0,i=t.controls;c<i.length;c++){var s=i[c];l+="".concat(s["control-name"],": <input type=range id=").concat(s["control-id"]," min=").concat(s["control-min"]," max=").concat(s["control-max"]," value=").concat(s["control-value"]," step=0.01>"),l+="<span id=".concat(s["control-label"],">???</span>"),l+=" | "}document.querySelector("#slider-controls").innerHTML=l,w(),document.querySelector("header").innerHTML="<h1>".concat(t.title,"</h1><p>").concat(t.instructions,"</p>")}(e)},c.open("GET","./data/av-data.json"),c.send(),function(){var c,w;c=P.sound1,w=window.AudioContext,e=new w,t=new Audio,u(c),r=e.createMediaElementSource(t),(n=e.createAnalyser()).fftSize=s.numSamples,(o=e.createBiquadFilter()).type="highshelf",o.frequency.setValueAtTime(1e3,e.currentTime),(l=e.createBiquadFilter()).type="lowshelf",l.frequency.setValueAtTime(1e3,e.currentTime),(a=e.createGain()).gain.value=s.gain,r.connect(o),o.connect(l),l.connect(n),n.connect(a),a.connect(e.destination);var S=document.querySelector("canvas");C(S),function(e,t){d=e.getContext("2d"),g=e.width,f=e.height,v=i(d,0,0,0,f,[{percent:0,color:"#00101c"},{percent:.33,color:"#041f3a"},{percent:.67,color:"#083f53"},{percent:1,color:"#239294"}]),p=t,b=new Uint8Array(p.fftSize/2),y=[new h({xPos:540,yPos:620,radius:184,barWidth:5,barMaxHeight:100,barPadding:4,fillColor:"rgba(14, 111, 128, .9)"}),new h({xPos:880,yPos:300,radius:120,barWidth:2.9,barMaxHeight:60,barPadding:3,fillColor:"rgba(27, 45, 112, .9)"}),new h({xPos:200,yPos:180,radius:50,barWidth:1.4,barMaxHeight:40,barPadding:1,fillColor:"rgba(6, 37, 87, .9)"})],m=0}(S,n),q()}()}})();
//# sourceMappingURL=bundle.js.map